<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulir Dana Kaget & Konversi Saldo</title>
    <link href="https://fonts.googleapis.com/css2?family=Cute+Font&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cute Font', cursive;
            background-color: #f7e6ff; /* Soft lavender background */
            color: #7b1fa2; /* Deep purple text */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding-bottom: 50px;
            overflow-x: hidden;
        }
        .intro-container {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 2s ease-in-out;
            padding: 20px;
            border-radius: 25px; /* More rounded */
            background-color: #ffffff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            max-width: 350px; /* Smaller max-width for intro text */
            width: 90%;
            box-sizing: border-box;
            border: 3px solid #ce93d8; /* Soft purple border */
        }
        .intro-text-box {
            white-space: pre-wrap; /* Preserve whitespace and line breaks */
            text-align: left;
            color: #8e24aa; /* Slightly darker purple for text */
            font-size: 8px; /* Disesuaikan menjadi 8px */
            line-height: 1.4;
            margin-bottom: 15px;
        }
        .intro-container h2 {
            font-size: 30px; /* Slightly smaller for cuter feel */
            color: #8e24aa;
            margin-top: 0;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }
        .intro-buttons {
            display: flex;
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
            justify-content: center;
            gap: 15px; /* Space between buttons */
            margin-top: 20px;
        }
        .intro-button {
            background-color: #ba68c8; /* Medium purple */
            color: white;
            border: none;
            padding: 12px 25px; /* Slightly smaller padding */
            border-radius: 30px; /* More rounded button */
            font-size: 20px; /* Adjusted font size */
            font-family: 'Cute Font', cursive;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            letter-spacing: 1px; /* Add some letter spacing */
            flex-grow: 1; /* Allow buttons to grow and fill space */
            max-width: 200px; /* Limit max width for individual buttons */
        }
        .intro-button:hover {
            background-color: #9c27b0; /* Darker purple on hover */
            transform: translateY(-2px) scale(1.03); /* Slight bounce and scale */
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        .intro-button.dana-kaget::before {
            content: 'üíñ'; /* Cute emoji */
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px; /* Smaller emoji size */
        }
         .intro-button.convert-saldo::before {
            content: 'üîÑ'; /* Convert emoji */
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }


        .container {
            background-color: #ffffff; /* Background putih sama seperti intro */
            padding: 30px;
            border-radius: 25px; /* Sama seperti intro */
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); /* Sama seperti intro */
            max-width: 400px;
            width: 90%;
            margin-bottom: 20px;
            border: 3px solid #ce93d8; /* Border solid ungu lembut sama seperti intro */
            animation: fadeInScale 1s ease-out;
        }
        h2 {
            text-align: center;
            color: #8e24aa; /* Warna ungu gelap */
            margin-bottom: 25px;
            font-size: 32px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.08);
        }
        label {
            display: block;
            margin-bottom: 10px;
            color: #7b1fa2; /* Ungu gelap */
            font-weight: bold;
            font-size: 18px;
        }
        input, textarea, select {
            width: calc(100% - 40px); /* Disesuaikan untuk lebih kecil, agar border kontainer terlihat */
            padding: 10px; /* Padding lebih kecil */
            margin-bottom: 20px;
            border: 2px solid #ce93d8; /* Border ungu lembut */
            background-color: #f3e5f5; /* Background ungu sangat terang */
            color: #7b1fa2; /* Warna teks ungu gelap */
            border-radius: 15px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        input:focus, textarea:focus, select:focus {
            border-color: #8e24aa;
            box-shadow: 0 0 8px rgba(142, 36, 170, 0.3);
            outline: none;
        }
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        .show-details-button, .submit-button, .back-button {
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 18px;
            font-family: 'Cute Font', cursive;
            cursor: pointer;
            width: calc(100% - 20px);
            max-width: 350px;
            margin: 15px auto;
            display: block;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            letter-spacing: 1px;
        }
        .show-details-button {
            background-color: #aed581; /* Soft green */
            color: white;
        }
        .show-details-button:hover {
            background-color: #8bc34a; /* Darker green */
            transform: translateY(-2px) scale(1.03);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        .submit-button {
            background-color: #ba68c8; /* Medium purple */
            color: white;
        }
        .submit-button:hover {
            background-color: #9c27b0; /* Darker purple */
            transform: translateY(-2px) scale(1.03);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        .back-button {
            background-color: #ffb74d; /* Soft orange */
            color: white;
        }
        .back-button:hover {
            background-color: #ff9800; /* Darker orange */
            transform: translateY(-2px) scale(1.03);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .qris-container {
            width: 100%;
            max-width: 250px;
            margin-top: 20px;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: fadeIn 1s ease-out;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border: 2px solid #ce93d8;
        }
        .qris-container h2 {
            font-size: 28px;
            margin-bottom: 15px;
        }
        .line {
            width: 80%;
            height: 2px;
            background-color: #ce93d8;
            margin: 10px 0;
            border-radius: 5px;
        }
        .qris-image {
            max-width: 90%;
            height: auto;
            display: block;
            margin: 0 auto;
            border-radius: 10px;
            border: 2px solid #ba68c8;
        }
        .qris-container p {
            font-size: 15px;
            color: #7b1fa2;
            margin-top: 10px;
        }
        .transaction-details {
            background-color: #f3e5f5;
            border: 2px solid #ce93d8;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            color: #7b1fa2;
            display: none;
            animation: fadeIn 1s ease-out;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .transaction-details p {
            margin: 6px 0;
            font-size: 16px;
        }
        .transaction-details strong {
            color: #8e24aa;
            font-size: 17px;
        }

        #form-dana-kaget, #form-convert-saldo {
            display: none; /* Hide both forms by default */
        }
        #summary-content {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 400px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>

    <audio id="background-music" loop>
        <source src="https://files.catbox.moe/et7tj5.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <div class="intro-container" id="intro-section">
        <div class="intro-text-box">
            ‚ï≠‚îÄ‚¨£„Äå _‚ú∞ ùêìùê¢ùê≠ùê¢ùê© ùêÉùêöùêßùêö ùêäùêöùê†ùêûùê≠ ‚úØ_ „Äç
            ‚îÇ Informasi Penting!
            ‚îÇ-----------------------
            ‚îÇ 1. Semua e-wallet bisa transaksi di aku
            ‚îÇ 2. Tidak ada biaya tambahan kalau pakai DANA
            ‚îÇ 3. Jasa pembuatan hanya 100 rupiah
            ‚îÇ 4. Bisa request nama
            ‚îÇ 5. Bisa request caption
            ‚îÇ 6. Amanah 100%
            ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚¨£
        </div>
        <h2>
            Pilih Layanan:
        </h2>
        <div class="intro-buttons">
            <button id="startButtonDanaKaget" class="intro-button dana-kaget">Dana Kaget</button>
            <button id="startButtonConvertSaldo" class="intro-button convert-saldo">Konversi Saldo</button>
        </div>
    </div>

    <div id="form-section">
        <div id="form-dana-kaget" class="container">
            <h2>Formulir Dana Kaget</h2>
            <form id="waFormDanaKaget">
                <label for="namaDanaKaget">Nama Pengirim:</label>
                <input type="text" id="namaDanaKaget" placeholder="Contoh: NARA ZAEN" required>

                <label for="captionDanaKaget">Pesan Spesial:</label>
                <textarea id="captionDanaKaget" rows="4" placeholder="Tulis pesan Dana Kagetmu di sini..." required></textarea>

                <label for="isiDanaKaget">Isi Dana Kaget per Pemenang (Rp):</label>
                <input type="number" id="isiDanaKaget" placeholder="Contoh: 5000" required>

                <label for="jumlahPemenang">Jumlah Pemenang:</label>
                <input type="number" id="jumlahPemenang" placeholder="Contoh: 10" required>

                <label for="paymentMethodDanaKaget">Metode Pembayaran:</label>
                <select id="paymentMethodDanaKaget" required>
                    <option value="">Pilih Metode Pembayaran</option>
                    <option value="qris">QRIS (Bebas Biaya)</option>
                    <option value="gopay">Gopay</option>
                    <option value="ovo">OVO</option>
                    <option value="shopeepay">ShopeePay</option>
                    <option value="linkaja">LinkAja</option>
                    <option value="banklain">Bank Lainnya</option>
                </select>

                <button type="button" id="showSummaryButtonDanaKaget" class="show-details-button">Lihat Rincian & QRIS</button>
            </form>
        </div>

        <div id="form-convert-saldo" class="container">
            <h2>Formulir Konversi Saldo</h2>
            <form id="waFormConvertSaldo">
                <label for="namaConvertSaldo">Nama Pengirim:</label>
                <input type="text" id="namaConvertSaldo" placeholder="Contoh: NARA ZAEN" required>

                <label for="jumlahSaldoConvert">Jumlah Saldo yang Dikonversi (Rp):</label>
                <input type="number" id="jumlahSaldoConvert" placeholder="Contoh: 100000" required>

                <label for="bankPengirim">Metode Pengirim:</label>
                <select id="bankPengirim" required>
                    <option value="">Pilih Metode Pengirim</option>
                    <option value="dana">DANA</option>
                    <option value="gopay">Gopay</option>
                    <option value="ovo">OVO</option>
                    <option value="shopeepay">ShopeePay</option>
                    <option value="linkaja">LinkAja</option>
                    <option value="bca">BCA</option>
                    <option value="mandiri">Mandiri</option>
                    <option value="bri">BRI</option>
                    <option value="bni">BNI</option>
                    <option value="btn">BTN</option>
                    <option value="cimb">CIMB Niaga</option>
                    <option value="bsi">BSI</option>
                    <option value="lainnya">Lainnya</option>
                </select>

                <label for="bankPenerima">Metode Penerima:</label>
                <select id="bankPenerima" required>
                    <option value="">Pilih Metode Penerima</option>
                    <option value="dana">DANA</option>
                    <option value="gopay">Gopay</option>
                    <option value="ovo">OVO</option>
                    <option value="shopeepay">ShopeePay</option>
                    <option value="linkaja">LinkAja</option>
                    <option value="bca">BCA</option>
                    <option value="mandiri">Mandiri</option>
                    <option value="bri">BRI</option>
                    <option value="bni">BNI</option>
                    <option value="btn">BTN</option>
                    <option value="cimb">CIMB Niaga</option>
                    <option value="bsi">BSI</option>
                    <option value="lainnya">Lainnya</option>
                </select>

                <label for="nomorPenerima">Nomor Rekening/ID Penerima:</label>
                <input type="text" id="nomorPenerima" placeholder="Contoh: 081234567890 (DANA) / 1234567890 (BCA)" required>

                <button type="button" id="showSummaryButtonConvertSaldo" class="show-details-button">Lihat Rincian & QRIS</button>
            </form>
        </div>

        <div id="summary-content">
            <div class="qris-container" id="qrisContainer">
                <div class="line"></div>
                <h2> SCAN QRIS </h2>
                <img src="https://h.top4top.io/p_3430euebb0.jpg" alt="QRIS Pembayaran" class="qris-image" width="150" height="250">
                <p><i>jangan lupa screenshot buktinya ya!</i></p>
                <div class="line"></div>
            </div>

            <div class="transaction-details" id="transactionDetails">
                </div>

            <button type="button" id="backToFormButton" class="back-button">Kembali ke Formulir</button>
            <button type="submit" class="submit-button" id="waSubmitButton">Kirim ke WhatsApp</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const introSection = document.getElementById('intro-section');
            const formSection = document.getElementById('form-section');
            const formDanaKaget = document.getElementById('form-dana-kaget');
            const formConvertSaldo = document.getElementById('form-convert-saldo');
            const summaryContent = document.getElementById('summary-content');

            const startButtonDanaKaget = document.getElementById('startButtonDanaKaget');
            const startButtonConvertSaldo = document.getElementById('startButtonConvertSaldo');
            const backgroundMusic = document.getElementById('background-music');
            const qrisContainer = document.getElementById('qrisContainer');
            const transactionDetails = document.getElementById('transactionDetails');
            const backToFormButton = document.getElementById('backToFormButton');
            const waSubmitButton = document.getElementById('waSubmitButton');

            // Dana Kaget elements
            const namaDanaKagetInput = document.getElementById('namaDanaKaget');
            const captionDanaKagetInput = document.getElementById('captionDanaKaget');
            const isiDanaKagetInput = document.getElementById('isiDanaKaget');
            const jumlahPemenangInput = document.getElementById('jumlahPemenang');
            const paymentMethodDanaKagetSelect = document.getElementById('paymentMethodDanaKaget');
            const showSummaryButtonDanaKaget = document.getElementById('showSummaryButtonDanaKaget');

            // Konversi Saldo elements
            const namaConvertSaldoInput = document.getElementById('namaConvertSaldo');
            const jumlahSaldoConvertInput = document.getElementById('jumlahSaldoConvert');
            const bankPengirimSelect = document.getElementById('bankPengirim');
            const bankPenerimaSelect = document.getElementById('bankPenerima');
            const nomorPenerimaInput = document.getElementById('nomorPenerima'); // New element
            const showSummaryButtonConvertSaldo = document.getElementById('showSummaryButtonConvertSaldo');

            const SERVICE_FEE_DK = 100;
            const PAYMENT_METHOD_ADDITIONAL_FEE_DK = 100; // For Dana Kaget if not QRIS

            const CONVERSION_COST_PER_100K = 5000;
            const CONVERSION_ADMIN_FEE_UNDER_50K = 2500; // New fee for conversion under 50k

            let currentFormType = ''; // To track which form is active: 'danaKaget' or 'convertSaldo'

            // Function to format number as Rupiah
            const formatRupiah = (angka) => {
                return angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            };

            // --- Calculation Functions ---

            function calculateDanaKagetDetails() {
                const isiDanaKaget = parseFloat(isiDanaKagetInput.value) || 0;
                const jumlahPemenang = parseFloat(jumlahPemenangInput.value) || 0;
                const selectedPaymentMethod = paymentMethodDanaKagetSelect.value;

                const totalDanaKaget = isiDanaKaget * jumlahPemenang;
                let currentPaymentMethodFee = 0;

                if (selectedPaymentMethod && selectedPaymentMethod !== 'qris') {
                    currentPaymentMethodFee = PAYMENT_METHOD_ADDITIONAL_FEE_DK;
                }

                const totalPembayaran = totalDanaKaget + SERVICE_FEE_DK + currentPaymentMethodFee;

                transactionDetails.innerHTML = `
                    <p>Total Dana Kaget: <strong id="displayTotalDanaKaget">Rp ${formatRupiah(totalDanaKaget)}</strong></p>
                    <p>Biaya Jasa: <strong>Rp ${formatRupiah(SERVICE_FEE_DK)}</strong></p>
                    <p id="displayPaymentMethodFee">Biaya Metode Pembayaran: <strong>Rp ${formatRupiah(currentPaymentMethodFee)}</strong></p>
                    <p>Total Pembayaran: <strong id="displayTotalPembayaran">Rp ${formatRupiah(totalPembayaran)}</strong></p>
                `;
            }

            function calculateConvertSaldoDetails() {
                const jumlahSaldoConvert = parseFloat(jumlahSaldoConvertInput.value) || 0;

                let conversionFee = 0;
                if (jumlahSaldoConvert > 0) {
                    if (jumlahSaldoConvert < 50000) {
                        conversionFee = CONVERSION_ADMIN_FEE_UNDER_50K;
                    } else {
                        const kelipatan100k = Math.ceil(jumlahSaldoConvert / 100000);
                        conversionFee = kelipatan100k * CONVERSION_COST_PER_100K;
                    }
                }

                const totalYangDiterima = jumlahSaldoConvert - conversionFee; // Penerima menerima saldo dikurangi biaya konversi
                const totalPembayaran = jumlahSaldoConvert; // Yang dibayarkan pengirim adalah jumlah saldo asli

                transactionDetails.innerHTML = `
                    <p>Saldo yang Dikonversi: <strong>Rp ${formatRupiah(jumlahSaldoConvert)}</strong></p>
                    <p>Biaya Konversi: <strong>Rp ${formatRupiah(conversionFee)}</strong></p>
                    <p>Total yang Diterima: <strong style="color: #4CAF50;">Rp ${formatRupiah(totalYangDiterima)}</strong></p>
                    <p>Total Pembayaran: <strong id="displayTotalPembayaran">Rp ${formatRupiah(totalPembayaran)}</strong></p>
                `;
            }

            // --- Event Listeners ---

            startButtonDanaKaget.addEventListener('click', function() {
                introSection.style.display = 'none';
                formSection.style.display = 'flex';
                formDanaKaget.style.display = 'block';
                formConvertSaldo.style.display = 'none';
                summaryContent.style.display = 'none';
                currentFormType = 'danaKaget';
                backgroundMusic.play().catch(error => {
                    console.log("Autoplay prevented:", error);
                });
            });

            startButtonConvertSaldo.addEventListener('click', function() {
                introSection.style.display = 'none';
                formSection.style.display = 'flex';
                formDanaKaget.style.display = 'none';
                formConvertSaldo.style.display = 'block';
                summaryContent.style.display = 'none';
                currentFormType = 'convertSaldo';
                backgroundMusic.play().catch(error => {
                    console.log("Autoplay prevented:", error);
                });
            });

            showSummaryButtonDanaKaget.addEventListener('click', function() {
                if (!namaDanaKagetInput.checkValidity() || !captionDanaKagetInput.checkValidity() ||
                    !isiDanaKagetInput.checkValidity() || parseFloat(isiDanaKagetInput.value) <= 0 ||
                    !jumlahPemenangInput.checkValidity() || parseFloat(jumlahPemenangInput.value) <= 0 ||
                    !paymentMethodDanaKagetSelect.value) {
                    alert('Mohon lengkapi semua data Dana Kaget dengan benar (nilai harus lebih dari 0 dan metode pembayaran dipilih).');
                    return;
                }
                calculateDanaKagetDetails();
                formDanaKaget.style.display = 'none';
                summaryContent.style.display = 'flex';
                qrisContainer.style.display = 'flex';
                transactionDetails.style.display = 'block';
                waSubmitButton.style.display = 'block';
                backToFormButton.style.display = 'block';
                summaryContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            showSummaryButtonConvertSaldo.addEventListener('click', function() {
                if (!namaConvertSaldoInput.checkValidity() || !jumlahSaldoConvertInput.checkValidity() ||
                    parseFloat(jumlahSaldoConvertInput.value) <= 0 ||
                    !bankPengirimSelect.value || !bankPenerimaSelect.value || !nomorPenerimaInput.checkValidity()) {
                    alert('Mohon lengkapi semua data Konversi Saldo dengan benar (jumlah saldo harus lebih dari 0, metode pengirim/penerima harus dipilih, dan nomor rekening/ID penerima tidak boleh kosong).');
                    return;
                }
                calculateConvertSaldoDetails();
                formConvertSaldo.style.display = 'none';
                summaryContent.style.display = 'flex';
                qrisContainer.style.display = 'flex';
                transactionDetails.style.display = 'block';
                waSubmitButton.style.display = 'block';
                backToFormButton.style.display = 'block';
                summaryContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });

            backToFormButton.addEventListener('click', function() {
                summaryContent.style.display = 'none';
                if (currentFormType === 'danaKaget') {
                    formDanaKaget.style.display = 'block';
                    formDanaKaget.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else if (currentFormType === 'convertSaldo') {
                    formConvertSaldo.style.display = 'block';
                    formConvertSaldo.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });

            // Real-time calculation updates for Dana Kaget
            isiDanaKagetInput.addEventListener('input', calculateDanaKagetDetails);
            jumlahPemenangInput.addEventListener('input', calculateDanaKagetDetails);
            paymentMethodDanaKagetSelect.addEventListener('change', calculateDanaKagetDetails);

            // Real-time calculation updates for Convert Saldo
            jumlahSaldoConvertInput.addEventListener('input', calculateConvertSaldoDetails);

            // WhatsApp Submission
            waSubmitButton.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default form submission if any

                let teksWhatsApp = '';
                const phoneNumber = '6285711374861'; // Nomor WhatsApp Anda

                if (currentFormType === 'danaKaget') {
                    const nama = namaDanaKagetInput.value;
                    const caption = captionDanaKagetInput.value;
                    const isiDanaKaget = parseFloat(isiDanaKagetInput.value) || 0;
                    const jumlahPemenang = parseFloat(jumlahPemenangInput.value) || 0;
                    const selectedPaymentMethod = paymentMethodDanaKagetSelect.value;
                    const paymentMethodText = paymentMethodDanaKagetSelect.options[paymentMethodDanaKagetSelect.selectedIndex].text;

                    const totalDanaKagetCalculated = isiDanaKaget * jumlahPemenang;
                    let currentPaymentMethodFee = 0;
                    if (selectedPaymentMethod && selectedPaymentMethod !== 'qris') {
                        currentPaymentMethodFee = PAYMENT_METHOD_ADDITIONAL_FEE_DK;
                    }
                    const totalPembayaranFinal = totalDanaKagetCalculated + SERVICE_FEE_DK + currentPaymentMethodFee;

                    teksWhatsApp = `*üíñ Transaksi Dana Kaget üíñ*\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n*üë§ Pengirim: ${nama}*\n*üí¨ Pesan: ${caption}*\n*üí∞ Isi Dana Kaget per Pemenang: Rp${formatRupiah(isiDanaKaget)}*\n*üèÜ Jumlah Pemenang: ${jumlahPemenang} orang*\n*üí≥ Metode Pembayaran: ${paymentMethodText}*\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n*‚ú® Total Dana Kaget: Rp${formatRupiah(totalDanaKagetCalculated)}*\n*üí∏ Biaya Jasa: Rp${formatRupiah(SERVICE_FEE_DK)}*\n*‚ûï Biaya ${paymentMethodText}: Rp${formatRupiah(currentPaymentMethodFee)}*\n*‚úÖ Total Pembayaran: Rp${formatRupiah(totalPembayaranFinal)}*\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n               _¬© Dana Kaget Chichuy_`;

                } else if (currentFormType === 'convertSaldo') {
                    const nama = namaConvertSaldoInput.value;
                    const jumlahSaldoConvert = parseFloat(jumlahSaldoConvertInput.value) || 0;
                    const bankPengirimText = bankPengirimSelect.options[bankPengirimSelect.selectedIndex].text;
                    const bankPenerimaText = bankPenerimaSelect.options[bankPenerimaSelect.selectedIndex].text;
                    const nomorPenerima = nomorPenerimaInput.value; // Get the recipient's number

                    let conversionFee = 0;
                    if (jumlahSaldoConvert > 0) {
                        if (jumlahSaldoConvert < 50000) {
                            conversionFee = CONVERSION_ADMIN_FEE_UNDER_50K;
                        } else {
                            const kelipatan100k = Math.ceil(jumlahSaldoConvert / 100000);
                            conversionFee = kelipatan100k * CONVERSION_COST_PER_100K;
                        }
                    }
                    const totalYangDiterima = jumlahSaldoConvert - conversionFee;
                    const totalPembayaranFinal = jumlahSaldoConvert; // Jumlah yang harus dibayarkan pengirim

                    teksWhatsApp = `*üîÑ Transaksi Konversi Saldo üîÑ*\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n*üë§ Pengirim: ${nama}*\n*üíµ Saldo Dikonversi: Rp${formatRupiah(jumlahSaldoConvert)}*\n*üè¶ Metode Pengirim: ${bankPengirimText}*\n*üí∏ Metode Penerima: ${bankPenerimaText}*\n*üÜî Rekening/ID Penerima: ${nomorPenerima}*\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n*üí∞ Biaya Konversi: Rp${formatRupiah(conversionFee)}*\n*‚úÖ Saldo yang Diterima: Rp${formatRupiah(totalYangDiterima)}*\n*‚úÖ Total Pembayaran: Rp${formatRupiah(totalPembayaranFinal)}*\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n               _¬© Dana Kaget Chichuy_`;
                }

                const encodedTeks = encodeURIComponent(teksWhatsApp);
                const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedTeks}`;
                window.open(whatsappUrl, '_blank');
            });
        });
    </script>
</body>
</html>
